<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Newtab</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://kit.fontawesome.com/87a560d2c6.js" crossorigin="anonymous"></script>
  <!-- Import fonts: Press Start 2P from Google and LCD from cdnfonts -->
  <style>
    @import url('https://fonts.cdnfonts.com/css/lcd');
    @import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Courier+Prime&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Lobster&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Oswald&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Bangers&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Pacifico&display=swap');

    body {
      margin: 0;
      font-family: 'Arial', sans-serif;
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      color: #fff;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
      transition: background-image 0.5s ease;
      background-color: #000000;
    }

    .center {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    .container {
      position: absolute;
      left: 20px;
      bottom: 100px;
      background-color: rgba(110, 110, 110, 0.68);
      border-radius: 1em;
      height: 60vh;
      overflow: scroll;
      overflow-x: hidden;
      padding: 1em;
      font-size: 1vh;
    }

    ::-webkit-scrollbar {
      width: 10px;
}

::-webkit-scrollbar-track {
  box-shadow: inset 0 0 5px grey; 
  border-radius: 10px;
}

::-webkit-scrollbar-thumb {
  background: rgba(0, 0, 0, 0.658);
  border-radius: 10px;
}
    input[type="text"] {
      padding: 1em 15em 1em 1em;
      background-color: rgb(255, 255, 255);
      box-shadow: none;
      border-width: 1px;
      font-size: 1em;
      border-radius: 50px;
      margin: 0.4rem;
      position: absolute;
      transform: translate(-14.1em, 10em);
    }

    .toprgb {
      background: linear-gradient(
        90deg,
        var(--gradient-start, #000000),
        var(--gradient-end, #000000),
        var(--gradient-start, #000000)
      );
      background-size: 200%;
      animation-name: rgb;
      animation-duration: 7s;
      animation-fill-mode: forwards;
      height: 4px;
      width: 100vw;
    }

    @keyframes rgb {
      0% {
        background-position-x: 0%;
      }
      100% {
        background-position-x: 200%;
      }
    }

    #clock {
      font-size: 6vw;
      /* When using LCD, set font-family accordingly */
      font-family: "Press Start 2P", "LCD", sans-serif;
      color: var(--clock-color, #ffffff);
      text-shadow: 0 0 10px var(--glow-color, #9d00e6),
        0 0 20px var(--glow-color, #9d00e6),
        0 0 30px var(--glow-color, #9d00e6),
        0 0 40px var(--glow-color, #a500e6),
        0 0 50px var(--glow-color, #c000e6),
        0 0 60px var(--glow-color, #9200e6),
        0 0 70px var(--glow-color, #8a00e6);
      cursor: grab;
      user-select: none;
      position: absolute;
    }

    .blur {
      filter: blur(8px);
      padding-top: 1em;
    }

    button {
      box-shadow: none;
      background-color: rgba(0, 0, 0, 0);
      color: rgba(255, 255, 255, 1);
      border: none;
      cursor: pointer;
    }

    h1 {
      font-size: 2rem;
      color: #ffffff;
    }

    #calendarContainer {
      display: none;
      position: absolute;
      /* Remove transform once dragging begins */
      background-color: rgba(0, 0, 0, 0.7);
      padding: 1em;
      border-radius: 10px;
      color: white;
      cursor: grab;
      user-select: none;
    }

    #calendar td.current-day {
      background-color: white;
      color: black;
      user-select: none;
    }

    #hour {
  color: var(--hour-color, #ff0000); /* Default red */
}

#minute {
  color: var(--minute-color, #00ff00); /* Default green */
}

  </style>
</head>
<body onload="init()">
  <div class="toprgb" style="position: absolute; top: 0;"></div>
  <div class="blur toprgb" style="position: absolute; top: -10px;"></div>

  <div id="clock">
    <span id="hour" style="color: #ffffff;">00</span>:<span id="minute" style="color: #ffffff;">00</span>
  </div>
  

  <div id="myDIV" style="display: none;">
    <div class="container">
      <h1>Background</h1>
      <input type="file" id="uploadImage" accept="image/*" aria-label="Upload background image" />
      <h1>Neon Gradient</h1>
      <label for="startColor">Start Color:</label>
      <input type="color" id="startColor" aria-label="Select start color" />
      <label for="endColor">End Color:</label>
      <input type="color" id="endColor" aria-label="Select end color" />
      <button id="toggleTopRGB" aria-label="Toggle top gradient" style="position: relative;">Toggle Top RGB</button>
      <h1>Colon Color</h1>
      <input type="color" id="clockColor" aria-label="Select clock color" />
      <h1>Hour Color</h1>
<input type="color" id="hourColor" aria-label="Select hour color" />

<h1>Minute Color</h1>
<input type="color" id="minuteColor" aria-label="Select minute color" />

      <h1>Clock Glow Color</h1>
      <input type="color" id="glowColor" aria-label="Select glow color" />
      <h1>Glow Alpha</h1>
      <input type="range" id="glowAlpha" min="0" max="1" step="0.01" value="1" aria-label="Select glow opacity" />
      <h1>Clock Font</h1>
      <select id="clockFont">
        <option value="Roboto">Roboto</option>
        <option value="Courier Prime">Courier Prime</option>
        <option value="Lobster">Lobster</option>
        <option value="Oswald">Oswald</option>
        <option value="Bangers">Bangers</option>
        <option value="Pacifico">Pacifico</option>
        <option value="Monospace">Monospace</option>
        <option value="LCD">LCD</option>
      </select>
      <h1>Calendar</h1>
      <button onclick="toggleCalendar()" aria-label="Toggle calendar">Toggle Calendar</button>
      <h1>Clock Size</h1>
      <input type="range" id="clockSizeInput" min="0" max="20" value="6" step="0.1" />
      <h1>Calendar Size</h1>
      <input type="range" id="calendarSizeInput" min="0.2" max="5" step="0.1" value="1">

    </div>
  </div>

  <div id="calendarContainer" style="width: fit-content;">
    <h1>Calendar</h1>
    <div id="calendar"></div>
  </div>

  <button onclick="myFunction()" aria-label="Toggle customization menu" style="position: absolute; bottom: 20px; left: 10px;">
    <i class="fa-solid fa-pen"></i>
  </button>
  <div class="toprgb blur" style="position: absolute; bottom: -10px;"></div>
  <div class="toprgb" style="position: absolute; bottom: 0;"></div>

  <script>

function keepElementInBounds(element) {
  const rect = element.getBoundingClientRect();
  const maxX = window.innerWidth - rect.width;
  const maxY = window.innerHeight - rect.height;

  let x = Math.max(0, Math.min(element.offsetLeft, maxX));
  let y = Math.max(0, Math.min(element.offsetTop, maxY));

  element.style.left = `${x}px`;
  element.style.top = `${y}px`;
}

// Call this after setting positions
  
    // ---------- Initialization & Settings ----------
    function init() {
  const savedStart = localStorage.getItem('gradientStart') || '#ff00ff';
  const savedEnd = localStorage.getItem('gradientEnd') || '#00ffff';
  const savedBackgroundImage = localStorage.getItem('backgroundImage');
  const savedClockColor = localStorage.getItem('clockColor') || '#ffffff';
  const savedClockFont = localStorage.getItem('clockFont') || 'Press Start 2P';
  const savedGlowColor = localStorage.getItem('glowColor') || '#9d00e6';
  const savedGlowAlpha = localStorage.getItem('glowAlpha') || 1;
  const savedClockSize = localStorage.getItem('clockFontSize') || 6; // Get saved clock size (default to 6)

  loadClockPosition();

  applyGradient(savedStart, savedEnd);
  document.getElementById('startColor').value = savedStart;
  document.getElementById('endColor').value = savedEnd;

  if (savedBackgroundImage) {
    document.body.style.backgroundImage = `url(${savedBackgroundImage})`;
  }
  

  document.documentElement.style.setProperty('--clock-color', savedClockColor);
  document.getElementById('clockColor').value = savedClockColor;

  document.getElementById('clockFont').value = savedClockFont;
  document.getElementById('clock').style.fontFamily = savedClockFont;

  document.getElementById('glowColor').value = savedGlowColor;
  document.getElementById('glowAlpha').value = savedGlowAlpha;
  updateGlowEffect(savedGlowColor, savedGlowAlpha);

  // Set the saved clock size
  document.getElementById('clock').style.fontSize = savedClockSize + 'vw';
  document.getElementById('clockSizeInput').value = savedClockSize; // Set input range to the saved value

  const toprgbElements = document.querySelectorAll('.toprgb');
  toprgbElements.forEach(el => el.style.display = localStorage.getItem('Toprgb') || 'block');

  if (localStorage.getItem('calendarVisible') === 'true') {
    document.getElementById('calendarContainer').style.display = 'block';
    renderCalendar();
  } else {
    document.getElementById('calendarContainer').style.display = 'none';
  }
}


    function applyGradient(startColor, endColor) {
      document.documentElement.style.setProperty('--gradient-start', startColor);
      document.documentElement.style.setProperty('--gradient-end', endColor);
      localStorage.setItem('gradientStart', startColor);
      localStorage.setItem('gradientEnd', endColor);
    }

    function updateGlowEffect(color, alpha) {
      const glowColor = `rgba(${hexToRgb(color)}, ${alpha})`;
      document.documentElement.style.setProperty('--glow-color', glowColor);
      localStorage.setItem('glowColor', color);
      localStorage.setItem('glowAlpha', alpha);
    }

    function hexToRgb(hex) {
      const r = parseInt(hex.slice(1, 3), 16);
      const g = parseInt(hex.slice(3, 5), 16);
      const b = parseInt(hex.slice(5, 7), 16);
      return `${r}, ${g}, ${b}`;
    }

    // ---------- Top RGB Toggle ----------
    document.getElementById('toggleTopRGB').addEventListener('click', () => {
      const toprgbElements = document.querySelectorAll('.toprgb');
      toprgbElements.forEach(el => {
        const newDisplay = (el.style.display === 'none') ? 'block' : 'none';
        el.style.display = newDisplay;
        localStorage.setItem('Toprgb', newDisplay);
      });
    });

    // ---------- DOMContentLoaded Listeners ----------
    document.addEventListener('DOMContentLoaded', () => {
      console.log("Current background image:", localStorage.getItem('backgroundImage'));

      document.getElementById('clockColor').addEventListener('input', function() {
        document.documentElement.style.setProperty('--clock-color', this.value);
        localStorage.setItem('clockColor', this.value);
      });

      document.getElementById('startColor').addEventListener('input', function() {
        applyGradient(this.value, document.getElementById('endColor').value);
      });

      document.getElementById('endColor').addEventListener('input', function() {
        applyGradient(document.getElementById('startColor').value, this.value);
      });

      document.getElementById('clockFont').addEventListener('change', function() {
        const selectedFont = this.value;
        document.getElementById('clock').style.fontFamily = selectedFont;
        localStorage.setItem('clockFont', selectedFont);
      });

      document.getElementById('uploadImage').addEventListener('change', function(event) {
        const file = event.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function(e) {
            const imageUrl = e.target.result;
            console.log("Uploaded image URL:", imageUrl);
            document.body.style.backgroundImage = `url(${imageUrl})`;
            localStorage.setItem('backgroundImage', imageUrl);
          };
          reader.readAsDataURL(file);
        }
      });

      document.getElementById('glowColor').addEventListener('input', function() {
        const glowColor = this.value;
        const glowAlpha = document.getElementById('glowAlpha').value;
        updateGlowEffect(glowColor, glowAlpha);
      });

      document.getElementById('glowAlpha').addEventListener('input', function() {
        const glowColor = document.getElementById('glowColor').value;
        updateGlowEffect(glowColor, this.value);
      });

      setInterval(showTime, 1000);
      showTime();
    });

    document.addEventListener('DOMContentLoaded', () => {
  // Load saved colors
  const savedHourColor = localStorage.getItem('hourColor') || '#ff0000';
  const savedMinuteColor = localStorage.getItem('minuteColor') || '#00ff00';

  document.getElementById('hour').style.color = savedHourColor;
  document.getElementById('minute').style.color = savedMinuteColor;

  document.getElementById('hourColor').value = savedHourColor;
  document.getElementById('minuteColor').value = savedMinuteColor;

  // Event listeners to change colors dynamically
  document.getElementById('hourColor').addEventListener('input', function() {
    document.getElementById('hour').style.color = this.value;
    localStorage.setItem('hourColor', this.value);
  });

  document.getElementById('minuteColor').addEventListener('input', function() {
    document.getElementById('minute').style.color = this.value;
    localStorage.setItem('minuteColor', this.value);
  });
});


    function showTime() {
  const time = new Date();
  const hour = String(time.getHours()).padStart(2, '0');
  const min = String(time.getMinutes()).padStart(2, '0');

  document.getElementById("hour").textContent = hour;
  document.getElementById("minute").textContent = min;
}
setInterval(showTime, 1000);
showTime(); // Call initially to display immediately

    function myFunction() {
      const x = document.getElementById("myDIV");
      x.style.display = (x.style.display === "none") ? "block" : "none";
    }

    // ---------- Clock Drag Functionality ----------
    function loadClockPosition() {
      const clock = document.getElementById("clock");
      const savedX = localStorage.getItem("clockX");
      const savedY = localStorage.getItem("clockY");
      if (savedX && savedY) {
        clock.style.left = savedX + "px";
        clock.style.top = savedY + "px";
      }
    }

    let isDragging = false;
    let offsetX, offsetY;
    document.getElementById("clock").addEventListener("mousedown", (e) => {
      isDragging = true;
      offsetX = e.clientX - document.getElementById("clock").getBoundingClientRect().left;
      offsetY = e.clientY - document.getElementById("clock").getBoundingClientRect().top;
      document.body.style.cursor = "grabbing";
    });

    document.addEventListener("mousemove", (e) => {
      if (isDragging) {
        document.getElementById("clock").style.left = `${e.clientX - offsetX}px`;
        document.getElementById("clock").style.top = `${e.clientY - offsetY}px`;
      }
    });

    document.addEventListener("mouseup", () => {
      if (isDragging) {
        isDragging = false;
        localStorage.setItem("clockX", document.getElementById("clock").offsetLeft);
        localStorage.setItem("clockY", document.getElementById("clock").offsetTop);
        document.body.style.cursor = "grab";
        keepElementInBounds(document.getElementById("clock"));
        
      }
    });

    // ---------- Calendar Drag Functionality (Duplicated from Clock) ----------
    let isCalendarDragging = false;
    let calendarOffsetX, calendarOffsetY;
    const calendarContainer = document.getElementById("calendarContainer");
    calendarContainer.addEventListener("mousedown", (e) => {
      isCalendarDragging = true;
      // Remove transform so dragging works correctly
      calendarOffsetX = e.clientX - calendarContainer.getBoundingClientRect().left;
      calendarOffsetY = e.clientY - calendarContainer.getBoundingClientRect().top;
      document.body.style.cursor = "grabbing";
    });

    document.addEventListener("mousemove", (e) => {
  if (isCalendarDragging) {
    calendarContainer.style.left = `${e.clientX - calendarOffsetX}px`;
    calendarContainer.style.top = `${e.clientY - calendarOffsetY}px`;
  }
});

document.addEventListener("mouseup", () => {
  if (isCalendarDragging) {
    isCalendarDragging = false;
    document.body.style.cursor = "default";
    
    // Save position and size
    localStorage.setItem("calendarX", calendarContainer.offsetLeft);
    localStorage.setItem("calendarY", calendarContainer.offsetTop);
    localStorage.setItem("calendarWidth", calendarContainer.offsetWidth);
    localStorage.setItem("calendarHeight", calendarContainer.offsetHeight);
  }
});

    // ---------- Calendar Toggle & Render ----------
    function toggleCalendar() {
      const calendar = document.getElementById("calendarContainer");
      const isVisible = calendar.style.display === "block";
      calendar.style.display = isVisible ? "none" : "block";
      localStorage.setItem("calendarVisible", !isVisible);
      if (!isVisible) renderCalendar();
    }

    function renderCalendar() {
      const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
      const now = new Date();
      const month = now.getMonth();
      const year = now.getFullYear();
      const firstDay = new Date(year, month, 1);
      const lastDay = new Date(year, month + 1, 0);

      let html = `<h2>${monthNames[month]} ${year}</h2><table><tr>`;
      for (let i = 0; i < 7; i++) {
        html += `<th>${["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"][i]}</th>`;
      }
      html += `</tr><tr>`;

      for (let i = 0; i < firstDay.getDay(); i++) {
        html += `<td></td>`;
      }

      for (let day = 1; day <= lastDay.getDate(); day++) {
        let classes = '';
        if (day === now.getDate()) classes = 'class="current-day"'; // Highlight current day
        if ((firstDay.getDay() + day - 1) % 7 === 0 && day !== 1) {
          html += `</tr><tr>`;
        }
        html += `<td ${classes}>${day}</td>`;
      }

      html += `</tr></table>`;
      document.getElementById('calendar').innerHTML = html;

      const calendar = document.getElementById("calendarContainer");
      const savedX = localStorage.getItem("calendarX");
      const savedY = localStorage.getItem("calendarY");
      if (savedX && savedY) {
        calendar.style.left = savedX + "px";
        calendar.style.top = savedY + "px";
      }

    }

    document.getElementById('clockSizeInput').addEventListener('input', function() {
  const fontSize = this.value + 'vw'; // Adjust the clock font size
  document.getElementById('clock').style.fontSize = fontSize;
  localStorage.setItem('clockFontSize', this.value); // Save the clock size to localStorage
});

document.addEventListener("DOMContentLoaded", () => {
    // Initialize calendar size from localStorage
    const savedCalendarSize = localStorage.getItem('calendarSize') || '1';
    document.getElementById('calendarContainer').style.transform = `scale(${savedCalendarSize})`;
    document.getElementById('calendarSizeInput').value = savedCalendarSize;

    // Event listener for resizing the calendar
    document.getElementById('calendarSizeInput').addEventListener('input', function () {
        const newSize = this.value;
        document.getElementById('calendarContainer').style.transform = `scale(${newSize})`;
        localStorage.setItem('calendarSize', newSize);
    });
});

  </script>
</body>
</html>
