<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <meta charset="UTF-8" />
  <title>Newtab</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://kit.fontawesome.com/87a560d2c6.js" crossorigin="anonymous"></script>
  <!-- Import fonts -->
  <style>
    @import url('https://fonts.cdnfonts.com/css/lcd');
    @import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Courier+Prime&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Lobster&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Oswald&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Bangers&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Pacifico&display=swap');
    
    body {
      margin: 0;
      font-family: 'Arial', sans-serif;
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      color: #ffffff;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
      background-color: #000000;
    }
    
    .container {
      position: absolute;
      left: 20px;
      bottom: 100px;
      background-color: rgba(0, 0, 0, 0.68);
      border-radius: 1em;
      height: 60vh;
      overflow-y: scroll;
      padding: 1em;
      font-size: 1vh;
      text-align: center;
    }
    
    input[type="text"] {
      padding: 1em 15em 1em 1em;
      background-color: #fff;
      font-size: 1em;
      border-radius: 50px;
      margin: 0.4rem;
      position: absolute;
      transform: translate(-14.1em, 10em);
      outline: none;
      border: none;
    }
    
    .google-apps-btn {
      display: grid;
      grid-template-columns: repeat(3, 10px);
      grid-template-rows: repeat(3, 10px);
      gap: 5px;
      cursor: pointer;
      position: absolute;
      top: 30px;
      right: 30px;
    }
    
    .dot {
      width: 7px;
      height: 7px;
      background-color: #fff;
      border-radius: 50%;
    }
    
    .apps-menu {
      display: none;
      background-color: rgba(0, 0, 0, 0.39);
      padding: 10px;
      position: absolute;
      top: 7vh;
      right: 2vw;
      border-radius: 1em;
    }
    
    .apps-menu ul {
      list-style: none;
      padding: 0;
    }
    
    .apps-menu ul li {
      padding: 8px 0;
    }
    
    .apps-menu ul li a {
      text-decoration: none;
      color: #fff;
    }
    
    .apps-menu ul li a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body onload="init(); renderLikedPhotosSelector(); setBackgroundFromSelected();">
  <div id="clock" style="display: none;">
    <span id="hour">00</span>:<span id="minute">00</span>
  </div>
  
  <form action="https://www.google.com/search" class="searchform" method="get" target="_self">
    <input type="hidden">
    <input class="form-control search" name="q" placeholder="Search" required type="text" autofocus autocomplete="off" />
  </form>
  
  <div class="google-apps-btn" onclick="toggleMenu()">
    <div class="dot"></div>
    <div class="dot"></div>
    <div class="dot"></div>
    <div class="dot"></div>
    <div class="dot"></div>
    <div class="dot"></div>
    <div class="dot"></div>
    <div class="dot"></div>
    <div class="dot"></div>
  </div>
  <div id="appsMenu" class="apps-menu">
    <ul>
      <li><a href="https://mail.google.com/"><i class="fas fa-envelope"></i> Gmail</a></li>
      <li><a href="https://www.youtube.com/"><i class="fab fa-youtube"></i> YouTube</a></li>
      <li><a href="https://drive.google.com/"><i class="fab fa-google-drive"></i> Drive</a></li>
      <li><a href="https://www.google.com/maps"><i class="fas fa-map-marker-alt"></i> Maps</a></li>
      <li><a href="https://docs.google.com/"><i class="fas fa-file-alt"></i> Docs</a></li>
      <li><a href="https://classroom.google.com/"><i class="fas fa-chalkboard-teacher"></i> Classroom</a></li>
      <li><a href="https://slides.google.com/"><i class="fas fa-file-powerpoint"></i> Slides</a></li>
      <li><a href="https://algot.fun"><i class="fas fa-code"></i> Algot.fun</a></li>
      <li><a href="https://chatgpt.com/"><i class="fas fa-comments"></i> ChatGPT</a></li>
    </ul>
  </div>

  <!-- Toggle button for Liked Photos Selector -->
  <button id="toggleLikedPhotosSelectorBtn" style="position:fixed;bottom:76px;left:20px;z-index:11;font-size:1.5em;background:#222222;color:#fff;border:none;border-radius:8px;width:48px;height:48px;display:flex;align-items:center;justify-content:center;">
    <i class="fas fa-images"></i>
  </button>

  <!-- Add the upload button and file input next to the liked photos selector -->

  <!-- Liked Photos Selector -->
  <div id="likedPhotosSelector" style="position:fixed;bottom:20px;left:20px;z-index:10;display:flex;gap:10px;display:none;"></div>

  <!-- Hidden file input for custom image upload -->
  <input type="file" id="customImageInput" accept="image/*" style="display:none" />

  <script>
    function toggleMenu() {
      const menu = document.getElementById('appsMenu');
      menu.style.display = (menu.style.display === 'none' || menu.style.display === '') ? 'block' : 'none';
    }

    // Render liked photos as selectable thumbnails
    function renderLikedPhotosSelector() {
      const likedPhotos = JSON.parse(localStorage.getItem('likedPhotos')) || [];
      const selector = document.getElementById('likedPhotosSelector');
      selector.innerHTML = '';

      // If there are liked photos, render them
      if (likedPhotos.length > 0) {
        likedPhotos.forEach((photo) => {
          const img = document.createElement('img');
          img.src = photo.src;
          img.alt = 'Liked Photo';
          img.style.width = '48px';
          img.style.height = '48px';
          img.style.objectFit = 'cover';
          img.style.borderRadius = '8px';
          img.style.border = (getSelectedPhotoSrc() === photo.src) ? '3px solid #fff' : '2px solid #888';
          img.style.cursor = 'pointer';
          img.title = 'Set as background';
          img.style.marginRight = '4px';
          img.onclick = function() {
            setSelectedPhotoSrc(photo.src);
            setBackgroundFromSelected();
            renderLikedPhotosSelector();
          };
          selector.appendChild(img);
        });
      } else {
        // Show default image if no liked photos
        const defaultImgUrl = "https://images.pexels.com/photos/11592804/pexels-photo-11592804.jpeg";
        const img = document.createElement('img');
        img.src = defaultImgUrl;
        img.alt = 'Default Photo';
        img.style.width = '48px';
        img.style.height = '48px';
        img.style.objectFit = 'cover';
        img.style.borderRadius = '8px';
        img.style.border = '3px solid #fff';
        img.style.cursor = 'default';
        img.title = 'Default background';
        img.style.marginRight = '4px';
        selector.appendChild(img);
      }

      // Always show the ... button
      const moreImg = document.createElement('img');
      moreImg.src = 'data:image/svg+xml;utf8,<svg width="32" height="32" xmlns="http://www.w3.org/2000/svg"><circle cx="8" cy="16" r="3" fill="white"/><circle cx="16" cy="16" r="3" fill="white"/><circle cx="24" cy="16" r="3" fill="white"/></svg>';
      moreImg.alt = 'More';
      moreImg.title = 'Go to Pexels page';
      moreImg.style.width = '48px';
      moreImg.style.height = '48px';
      moreImg.style.objectFit = 'cover';
      moreImg.style.borderRadius = '8px';
      moreImg.style.border = '2px solid #888';
      moreImg.style.cursor = 'pointer';
      moreImg.style.background = '#222';
      moreImg.style.marginLeft = '4px';
      moreImg.onclick = function(e) {
        e.stopPropagation();
        window.open('pexels.html', '_blank');
      };
      selector.appendChild(moreImg);

      // Show the upload icon as a FontAwesome icon in the menu
      const uploadBtn = document.createElement('button');
      uploadBtn.type = 'button';
      uploadBtn.title = 'Upload your own image';
      uploadBtn.style.width = '48px';
      uploadBtn.style.height = '48px';
      uploadBtn.style.display = 'flex';
      uploadBtn.style.alignItems = 'center';
      uploadBtn.style.justifyContent = 'center';
      uploadBtn.style.background = '#222';
      uploadBtn.style.border = '2px solid #888';
      uploadBtn.style.borderRadius = '8px';
      uploadBtn.style.marginLeft = '4px';
      uploadBtn.style.cursor = 'pointer';
      uploadBtn.innerHTML = '<i class="fas fa-upload" style="color:white;font-size:1.5em;"></i>';
      uploadBtn.onclick = function(e) {
        e.stopPropagation();
        document.getElementById('customImageInput').click();
      };
      selector.appendChild(uploadBtn);
    }

    // Store the selected photo src in localStorage
    function setSelectedPhotoSrc(src) {
      localStorage.setItem('selectedLikedPhoto', src);
    }
    function getSelectedPhotoSrc() {
      return localStorage.getItem('selectedLikedPhoto');
    }

    // Set background from selected liked photo, or fallback to random if none selected
    function setBackgroundFromSelected() {
      const likedPhotos = JSON.parse(localStorage.getItem('likedPhotos')) || [];
      const selected = getSelectedPhotoSrc();
      if (likedPhotos.length === 0) {
        document.body.style.backgroundImage = 'url("https://images.pexels.com/photos/11592804/pexels-photo-11592804.jpeg")';
        return;
      }
      if (selected && likedPhotos.some(p => p.src === selected)) {
        document.body.style.backgroundImage = `url(${selected})`;
      } else if (likedPhotos.length > 0) {
        const randomPhoto = likedPhotos[Math.floor(Math.random() * likedPhotos.length)];
        document.body.style.backgroundImage = `url(${randomPhoto.src})`;
        setSelectedPhotoSrc(randomPhoto.src);
      }
    }

    // Toggle the visibility of the liked photos selector or go to /pexels.html if no liked photos
    document.getElementById('toggleLikedPhotosSelectorBtn').onclick = function() {
      const likedPhotos = JSON.parse(localStorage.getItem('likedPhotos')) || [];
      const selector = document.getElementById('likedPhotosSelector');
      if (likedPhotos.length === 0) {
        window.location.href = 'pexels.html';
      } else {
        selector.style.display = (selector.style.display === 'none' || selector.style.display === '') ? 'flex' : 'none';
      }
    };

    // Handle file selection
    document.getElementById('customImageInput').onchange = function(event) {
      const file = event.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(e) {
        // Save the uploaded image as a "liked photo" with a special marker
        const likedPhotos = JSON.parse(localStorage.getItem('likedPhotos')) || [];
        likedPhotos.push({ src: e.target.result, photographer: "You" });
        localStorage.setItem('likedPhotos', JSON.stringify(likedPhotos));
        setSelectedPhotoSrc(e.target.result);
        setBackgroundFromSelected();
        renderLikedPhotosSelector();
      };
      reader.readAsDataURL(file);
      // Reset input so the same file can be uploaded again if desired
      event.target.value = '';
    };

    // Dummy init() function (update as needed)
    function init() {
      // Initialization code goes here.
    }
  </script>
</body>
</html>